{% extends '@EasyAdmin/page/content.html.twig' %}

{% block content_title %}Mes ventes{% endblock %}


{% block page_actions %}
    {% set url = ea_url()
        .setAction('new') %}
    <div class="global-actions">
        <a class=" action-new btn btn-primary" href="{{ url }}" data-action-name="new">
            <i class="action-icon fa fa-plus-square"></i> <span class="action-label">Créer une vente</span>
        </a>
    </div>
{% endblock %}


{% block main %}

    <nav>
        <div class="nav nav-pills flex-column flex-sm-row" id="nav-tab" role="tablist">
            <button class="flex-sm-fill text-sm-center nav-link active" id="nav-event-tab" data-bs-toggle="tab" data-bs-target="#nav-event" type="button" role="tab" aria-controls="nav-event" aria-selected="true">Field Events</button>
            <button class="flex-sm-fill text-sm-center nav-link" id="nav-sponsoring-tab" data-bs-toggle="tab" data-bs-target="#nav-sponsoring" type="button" role="tab" aria-controls="nav-sponsoring" aria-selected="false">Sponsoring</button>
            <button class="flex-sm-fill text-sm-center nav-link" id="nav-package-tab" data-bs-toggle="tab" data-bs-target="#nav-package" type="button" role="tab" aria-controls="nav-package" aria-selected="false">Package VIP</button>
            <button class="flex-sm-fill text-sm-center nav-link" id="nav-divers-tab" data-bs-toggle="tab" data-bs-target="#nav-divers" type="button" role="tab" aria-controls="nav-divers" aria-selected="false">Divers</button>
        </div>
    </nav>


    <div class="tab-content" id="nav-tabContent">
    <div class="tab-pane fade show active mt-3" id="nav-event" role="tabpanel" aria-labelledby="nav-event-tab">
        <h3 class="text-uppercase text-center font-weight-bolder verhulst">Field Events</h3>
        <table class="table table-hover">
            <thead class="table-primary">
            <tr>
                <th scope="col">Société</th>
                <th scope="col">Projet</th>
                <th scope="col">Produit</th>
                <th scope="col">Date</th>
                <th scope="col">CA</th>
                <th scope="col">PA</th>
                <th scope="col">Marge</th>
                <th scope="col">% Sales</th>
                <th scope="col">€ Sales</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            {% for sale in user.sales %}
                {% if get_class(sale.product) == 'ProductEvent' %}
                    <tr>
                        <th scope="row">
                            {% for contact in sale.contact %}
                                {{ contact.firstname }} {{ contact.lastname }} ({{ contact.company.name }})<br>
                            {% endfor %}
                        </th>
                        <th scope="row">
                            {{ sale.product.project.name }}
                        </th>
                        <th scope="row">{{ sale.product.name }}</th>
                        <td>{{ sale.date|date('d/m/Y') }}</td>
                        <td>{{ (sale.price/100)|number_format(2, ',', ' ') }} €</td>
                        <td>{{ (sale.pa)|number_format(2, ',', ' ') }} €</td>
                        <td> {{ sale.marge|number_format(2, ',', ' ') }} €</td>
                        <td>{{ sale.percentCom }} %</td>
                        <td>{{ sale.euroCom|number_format(2, ',', ' ') }}  €</td>
                        <td class="action">
                            {% set url_edit = ea_url()
                                .setAction('edit')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            {% set url_delete = ea_url()
                                .setAction('delete')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            <a class=" action-edit" href="{{ url_edit }}" title="Edit" data-action-name="edit"><i class="action-icon fa fa-pencil-alt"></i> <span class="action-label">Edit</span></a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="tab-pane fade mt-3" id="nav-sponsoring" role="tabpanel" aria-labelledby="nav-sponsoring-tab">
        <h3 class="text-uppercase text-center font-weight-bolder verhulst">Sponsoring</h3>
        <table class="table table-hover">
            <thead class="table-primary">
            <tr>
                <th scope="col">Société</th>
                <th scope="col">Date</th>
                <th scope="col">CA</th>
                <th scope="col">PA</th>
                <th scope="col">Marge Event</th>
                <th scope="col">Com Sales</th>
                <th scope="col">Marge Verhulst</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            {% for sale in user.sales %}
                {% if get_class(sale.product) == 'ProductSponsoring' %}
                    <tr>
                        <th scope="row">
                            {% for contact in sale.contact %}
                                {{ contact.firstname }} {{ contact.lastname }} ({{ contact.company.name }})<br>
                            {% endfor %}
                        </th>
                        <td>{{ sale.date|date('d/m/Y') }}</td>
                        <td>{{ (sale.price/100)|number_format(2, ',', ' ') }}</td>
                        <td>?</td>
                        <td>?</td>
                        <td>{{ sale.percentCom }} %</td>
                        <td>{{ sale.percentVr }} %</td>
                        <td class="action">
                            {% set url_edit = ea_url()
                                .setAction('edit')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            {% set url_delete = ea_url()
                                .setAction('delete')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            <a class=" action-edit" href="{{ url_edit }}" title="Edit" data-action-name="edit"><i class="action-icon fa fa-pencil-alt"></i> <span class="action-label">Edit</span></a>
                            <a class=" action-delete text-danger" href="{{ url_delete }}" title="Delete" data-action-name="delete" formaction="{{ url_delete }}" data-bs-toggle="modal" data-bs-target="#modal-delete"><i class="action-icon fa fa-trash"></i> <span class="action-label">Delete</span></a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="tab-pane fade mt-3" id="nav-package" role="tabpanel" aria-labelledby="nav-package-tab">
        <h3 class="text-uppercase text-center font-weight-bolder verhulst">Package VIP</h3>
        <table class="table table-hover">
            <thead class="table-primary">
            <tr>
                <th scope="col">Société</th>
                <th scope="col">Date</th>
                <th scope="col">CA</th>
                <th scope="col">PA</th>
                <th scope="col">Marge Event</th>
                <th scope="col">Com Sales</th>
                <th scope="col">Marge Verhulst</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            {% for sale in user.sales %}
                {% if get_class(sale.product) == 'ProductPackageVip' %}
                    <tr>
                        <th scope="row">
                            {% for contact in sale.contact %}
                                {{ contact.firstname }} {{ contact.lastname }} ({{ contact.company.name }})<br>
                            {% endfor %}
                        </th>
                        <td>{{ sale.date|date('d/m/Y') }}</td>
                        <td>{{ (sale.price/100)|number_format(2, ',', ' ') }}</td>
                        <td>?</td>
                        <td>?</td>
                        <td>{{ sale.percentCom }} %</td>
                        <td>{{ sale.percentVr }} %</td>
                        <td class="action">
                            {% set url_edit = ea_url()
                                .setAction('edit')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            {% set url_delete = ea_url()
                                .setAction('delete')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            <a class=" action-edit" href="{{ url_edit }}" title="Edit" data-action-name="edit"><i class="action-icon fa fa-pencil-alt"></i> <span class="action-label">Edit</span></a>
                            <a class=" action-delete text-danger" href="{{ url_delete }}" title="Delete" data-action-name="delete" formaction="{{ url_delete }}" data-bs-toggle="modal" data-bs-target="#modal-delete"><i class="action-icon fa fa-trash"></i> <span class="action-label">Delete</span></a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>
    </div>

    <div class="tab-pane fade mt-3" id="nav-divers" role="tabpanel" aria-labelledby="nav-divers-tab">
        <h3 class="text-uppercase text-center font-weight-bolder verhulst">Divers</h3>
        <table class="table table-hover">
            <thead class="table-primary">
            <tr>
                <th scope="col">Société</th>
                <th scope="col">Date</th>
                <th scope="col">CA</th>
                <th scope="col">PA</th>
                <th scope="col">Marge Event</th>
                <th scope="col">Com Sales</th>
                <th scope="col">Marge Verhulst</th>
                <th scope="col">Action</th>
            </tr>
            </thead>
            <tbody>
            {% for sale in user.sales %}
                {% if get_class(sale.product) == 'ProductDivers' %}
                    <tr>
                        <th scope="row">
                            {% for contact in sale.contact %}
                                {{ contact.firstname }} {{ contact.lastname }} ({{ contact.company.name }})<br>
                            {% endfor %}
                        </th>
                        <td>{{ sale.date|date('d/m/Y') }}</td>
                        <td>{{ (sale.price/100)|number_format(2, ',', ' ') }}</td>
                        <td>?</td>
                        <td>?</td>
                        <td>{{ sale.percentCom }} %</td>
                        <td>{{ sale.percentVr }} %</td>
                        <td class="action">
                            {% set url_edit = ea_url()
                                .setAction('edit')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                                .setEntityId(sale.id)
                            %}
                            {% set url_delete = ea_url()
                                .setAction('delete')
                                .setController('App\\Controller\\Admin\\SalesCrudController')
                            %}
                            <a class=" action-edit" href="{{ url_edit }}" title="Edit" data-action-name="edit"><i class="action-icon fa fa-pencil-alt"></i> <span class="action-label">Edit</span></a>
                        </td>
                    </tr>
                {% endif %}
            {% endfor %}
            </tbody>
        </table>
    </div>
{% endblock %}